---
- name: coordinfo
  desc: Latency, error and coordinates from Tor relay logfiles
  regex: '(.*)\s\[info\].*\(latency=([0-9.]+)\)\s\(error=([0-9.]+)\)\s\(coord=\[(.*)\]\)\s\(viv_dist=([0-9.]+)\)'
  fields:
    - type: time
      name: time
    - type: float
      name: actual
    - name: remote_error
      type: float
    - name: coord
      type: list
      separator: ' '
      subtype: float
      strip: True
    - name: estimated
      type: float
- name: pingbound
  desc: Parser output of PingBound protection from Tor log files
  regex: '(.*)\s\[notice\].*\[PingBound] (Failed.|Passed.).*\[lbound: ([0-9.]+), ubound: ([0-9.]+), latency: ([0-9.]+)\]'
  fields:
    - name: time
      type: time
    - name: passed
      type: boolean
      truth: 'Passed.'
    - name: lbound
      type: float
    - name: ubound
      type: float
    - name: latency
      type: float


